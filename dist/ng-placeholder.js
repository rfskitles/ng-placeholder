!function(e){function t(a){if(n[a])return n[a].exports;var i=n[a]={exports:{},id:a,loaded:!1};return e[a].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){var a,i;a=[n,t,n(1),n(2),n(3)],i=function(e,t,n,a,i){"use strict";var r=angular.module("ng-placeholder",["ngAnimate"]);r.provider("NgPlaceholderConfig",[n.PlaceholderProvider]),r.service("NgPlaceholderService",["$templateCache","NgPlaceholderConfig",a.PlaceholderService.getInstant]),r.directive("ngPlaceholder",["$animate","NgPlaceholderService",i.PlaceholderDirective])}.apply(t,a),!(void 0!==i&&(e.exports=i))},function(e,t,n){var a,i;a=[n,t],i=function(e,t){"use strict";var n=function(){function e(e,t,n,a){void 0===e&&(e=[]),void 0===n&&(n=!0),void 0===a&&(a="ng-cloak"),this.configs=e,this["default"]=t,this.enable=n,this.className=a}return e.prototype.getTemplates=function(){return this.configs},e.prototype.getDefaultTemplate=function(){return this["default"]},e.prototype.getClassName=function(){return this.className},e.prototype.isEnabled=function(){return this.enable},e}();t.ConfigService=n;var a=function(){function e(){this.configs=new Array,this.customClass="ng-placeholder-hide",this.defaultConfig={template_id:"default",template_html:"<p>Loading...</p>",template_repeats:1}}return e.prototype.addConfig=function(e){this.configs.push(e)},e.prototype.setConfigs=function(e){this.configs=e},e.prototype.setCustomClass=function(e){this.customClass=e},e.prototype.setDefaultConfig=function(e){this.defaultConfig=e},e.prototype.enable=function(){this.active=!0},e.prototype.disable=function(){this.active=!1},e.prototype.$get=function(){return new n(this.configs,this.defaultConfig,this.active,this.customClass)},e}();t.PlaceholderProvider=a}.apply(t,a),!(void 0!==i&&(e.exports=i))},function(e,t,n){var a,i;a=[n,t],i=function(e,t){"use strict";var n=function(){function e(e,t,n){this.configs=e,this.defaultConfig=t,this.className=n}return e.getInstant=function(t,n){if(angular.isUndefined(e.instant)){var a=n.getDefaultTemplate(),i=e.compileConfigs(n.getTemplates(),t),r=e.buildConfig(a.template_id,a.template_html,a.template_repeats);e.instant=new e(i,r,n.getClassName())}return e.instant},e.getTemplateHtml=function(e,t){return t.get(e)},e.repeatTemplate=function(e,t){var n=angular.copy(e);t-=1;for(var a=0;a<t;a++)n+=e;return n},e.buildConfig=function(t,n,a){var i=e.repeatTemplate(n,a);return{template_id:t,template_html:n,template_repeat:a,template_compiled:angular.element(i)}},e.compileConfigs=function(t,n){var a,i,r,o,l=new Array;return t.forEach(function(t){i=t.template_id,r=e.getTemplateHtml(t.template_path,n)||t.template_html,o=t.template_repeats||1,a=e.buildConfig(i,r,o),l.push(a)}),l},e.prototype.repeatTemplate=function(t,n){if(t.template_repeat===n||angular.isUndefined(n))return t.template_compiled;var a=e.repeatTemplate(t.template_html,n);return angular.element(a)},e.prototype.getTemplate=function(e,t){var n=this,a=n.defaultConfig.template_compiled;return n.configs.forEach(function(i){if(i.template_id===e)return void(a=n.repeatTemplate(i,t))}),a},e.prototype.getClassName=function(){return this.className},e}();t.PlaceholderService=n}.apply(t,a),!(void 0!==i&&(e.exports=i))},function(e,t,n){var a,i;a=[n,t],i=function(e,t){"use strict";function n(e,t){return{transclude:"element",link:function(e,n,a,i,r){var o,l=a.templateId,s=parseInt(a.templateRepeats,10),p=t.getTemplate(l,s),c=t.getClassName();r(e,function(e,t){o=e.children();for(var a=0;a<o.length;a++)o[a]=angular.element(o[a]),o[a].addClass(c);e.append(p),n.replaceWith(e)}),a.$observe("showUntil",function(e){if("true"===e){for(var t=0;t<o.length;t++)o[t].removeClass(c);p.remove()}})}}}t.PlaceholderDirective=n}.apply(t,a),!(void 0!==i&&(e.exports=i))}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vZGlzdC9uZy1wbGFjZWhvbGRlci5qcyIsIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgODBiN2QxNGE1MTJhYjczODllNGYiLCJ3ZWJwYWNrOi8vLy4vc3JjL25nLXBsYWNlaG9sZGVyLnRzIiwid2VicGFjazovLy8uL3NyYy9uZy1wbGFjZWhvbGRlci1wcm92aWRlci50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbmctcGxhY2Vob2xkZXItc2VydmljZS50cyIsIndlYnBhY2s6Ly8vLi9zcmMvbmctcGxhY2Vob2xkZXItZGlyZWN0aXZlLnRzIl0sIm5hbWVzIjpbIm1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJpbnN0YWxsZWRNb2R1bGVzIiwiZXhwb3J0cyIsIm1vZHVsZSIsImlkIiwibG9hZGVkIiwiY2FsbCIsIm0iLCJjIiwicCIsIl9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18iLCJfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyIsInJlcXVpcmUiLCJuZ19wbGFjZWhvbGRlcl9wcm92aWRlcl8xIiwibmdfcGxhY2Vob2xkZXJfc2VydmljZV8xIiwibmdfcGxhY2Vob2xkZXJfZGlyZWN0aXZlXzEiLCJhcHAiLCJhbmd1bGFyIiwicHJvdmlkZXIiLCJQbGFjZWhvbGRlclByb3ZpZGVyIiwic2VydmljZSIsIlBsYWNlaG9sZGVyU2VydmljZSIsImdldEluc3RhbnQiLCJkaXJlY3RpdmUiLCJQbGFjZWhvbGRlckRpcmVjdGl2ZSIsImFwcGx5IiwidW5kZWZpbmVkIiwiQ29uZmlnU2VydmljZSIsImNvbmZpZ3MiLCJkZWZhdWx0Q29uZmlnIiwiZW5hYmxlIiwiY2xhc3NOYW1lIiwidGhpcyIsInByb3RvdHlwZSIsImdldFRlbXBsYXRlcyIsImdldERlZmF1bHRUZW1wbGF0ZSIsImdldENsYXNzTmFtZSIsImlzRW5hYmxlZCIsIkFycmF5IiwiY3VzdG9tQ2xhc3MiLCJ0ZW1wbGF0ZV9pZCIsInRlbXBsYXRlX2h0bWwiLCJ0ZW1wbGF0ZV9yZXBlYXRzIiwiYWRkQ29uZmlnIiwiY29uZmlnIiwicHVzaCIsInNldENvbmZpZ3MiLCJzZXRDdXN0b21DbGFzcyIsInNldERlZmF1bHRDb25maWciLCJhY3RpdmUiLCJkaXNhYmxlIiwiJGdldCIsImNvbXBpbGVkQ29uZmlncyIsImRlZmF1bHRDb21waWxlZENvbmZpZyIsIiR0ZW1wbGF0ZUNhY2hlIiwicGxhY2Vob2xkZXJDb25maWdzIiwiaXNVbmRlZmluZWQiLCJpbnN0YW50IiwiY29tcGlsZUNvbmZpZ3MiLCJjb21waWxlZERlZmF1bHRDb25maWdzIiwiYnVpbGRDb25maWciLCJnZXRUZW1wbGF0ZUh0bWwiLCJ0ZW1wbGF0ZV9wYXRoIiwidGVtcGxhdGVDYWNoZSIsImdldCIsInJlcGVhdFRlbXBsYXRlIiwidGVtcGxhdGVfcmVwZWF0IiwiaHRtbCIsImNvcHkiLCJpbmRleCIsInRlbXBsYXRlIiwidGVtcGxhdGVfY29tcGlsZWQiLCJlbGVtZW50IiwiY29tcGlsZWRDb25maWciLCJmb3JFYWNoIiwiZ2V0VGVtcGxhdGUiLCJzZWxmIiwiJGFuaW1hdGUiLCJwbGFjZWhvbGRlclNlcnZpY2UiLCJ0cmFuc2NsdWRlIiwibGluayIsInNjb3BlIiwiYXR0cnMiLCJjb250cm9sbGVyIiwidHJhbnNjbHVkZUZuIiwiY2hpbGRyZW5zIiwidGVtcGxhdGVJZCIsInBhcnNlSW50IiwidGVtcGxhdGVSZXBlYXRzIiwiY2xvbmUiLCJjaGlsZHJlbiIsImxlbmd0aCIsImFkZENsYXNzIiwiYXBwZW5kIiwicmVwbGFjZVdpdGgiLCIkb2JzZXJ2ZSIsInZhbHVlIiwicmVtb3ZlQ2xhc3MiLCJyZW1vdmUiXSwibWFwcGluZ3MiOiJDQUFTLFNBQVVBLEdDSW5CLFFBQUFDLEdBQUFDLEdBR0EsR0FBQUMsRUFBQUQsR0FDQSxNQUFBQyxHQUFBRCxHQUFBRSxPQUdBLElBQUFDLEdBQUFGLEVBQUFELElBQ0FFLFdBQ0FFLEdBQUFKLEVBQ0FLLFFBQUEsRUFVQSxPQU5BUCxHQUFB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QUFZSSxFQUFNQyxVQUVsQixLQUFLLEdBQUlyQixHQUFRLEVBQUdBLEVBQVFnQixFQUFVTSxPQUFRdEIsSUFDMUNnQixFQUFVaEIsR0FBU3BELFFBQVF1RCxRQUFRYSxFQUFVaEIsSUFDN0NnQixFQUFVaEIsR0FBT3VCLFNBQVM3RCxFQUc5QjBELEdBQU1JLE9BQU92QixHQUNiRSxFQUFRc0IsWUFBWUwsS0FHeEJQLEVBQU1hLFNBQVMsWUFBYSxTQUFDQyxHQUN6QixHQUFjLFNBQVZBLEVBQWtCLENBQ2xCLElBQUssR0FBSTNCLEdBQVEsRUFBR0EsRUFBUWdCLEVBQVVNLE9BQVF0QixJQUMxQ2dCLEVBQVVoQixHQUFPNEIsWUFBWWxFLEVBRWpDdUMsR0FBUzRCLGNBbENiaEcsRUFBQXNCLHFCQUFvQkEsR0wyT2pDQyxNQUFNdkIsRUFBU1EsS0FBaUVnQixTQUFsQ2YsSUFBZ0RSLEVBQU9ELFFBQVVTIiwiZmlsZSI6Ii4vZGlzdC9uZy1wbGFjZWhvbGRlci5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXBcbi8qKioqKiovIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbi8qKioqKiovIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbi8qKioqKiovIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbi8qKioqKiovIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuLyoqKioqKi8gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbi8qKioqKiovIFx0XHRcdGV4cG9ydHM6IHt9LFxuLyoqKioqKi8gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuLyoqKioqKi8gXHRcdFx0bG9hZGVkOiBmYWxzZVxuLyoqKioqKi8gXHRcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuLyoqKioqKi8gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4vKioqKioqLyBcdFx0bW9kdWxlLmxvYWRlZCA9IHRydWU7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4vKioqKioqLyBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuLyoqKioqKi8gXHR9XG4vKioqKioqL1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vKioqKioqLyBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuLyoqKioqKi8gfSlcbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vKioqKioqLyAoW1xuLyogMCAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0dmFyIF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fOyEoX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXyA9IFtfX3dlYnBhY2tfcmVxdWlyZV9fLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDEpLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpLCBfX3dlYnBhY2tfcmVxdWlyZV9fKDMpXSwgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18gPSBmdW5jdGlvbiAocmVxdWlyZSwgZXhwb3J0cywgbmdfcGxhY2Vob2xkZXJfcHJvdmlkZXJfMSwgbmdfcGxhY2Vob2xkZXJfc2VydmljZV8xLCBuZ19wbGFjZWhvbGRlcl9kaXJlY3RpdmVfMSkge1xuXHQgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cdCAgICB2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ25nLXBsYWNlaG9sZGVyJywgWyduZ0FuaW1hdGUnXSk7XG5cdCAgICBhcHAucHJvdmlkZXIoJ05nUGxhY2Vob2xkZXJDb25maWcnLCBbbmdfcGxhY2Vob2xkZXJfcHJvdmlkZXJfMS5QbGFjZWhvbGRlclByb3ZpZGVyXSk7XG5cdCAgICBhcHAuc2VydmljZSgnTmdQbGFjZWhvbGRlclNlcnZpY2UnLCBbJyR0ZW1wbGF0ZUNhY2hlJywgJ05nUGxhY2Vob2xkZXJDb25maWcnLCBuZ19wbGFjZWhvbGRlcl9zZXJ2aWNlXzEuUGxhY2Vob2xkZXJTZXJ2aWNlLmdldEluc3RhbnRdKTtcblx0ICAgIGFwcC5kaXJlY3RpdmUoJ25nUGxhY2Vob2xkZXInLCBbJyRhbmltYXRlJywgJ05nUGxhY2Vob2xkZXJTZXJ2aWNlJywgbmdfcGxhY2Vob2xkZXJfZGlyZWN0aXZlXzEuUGxhY2Vob2xkZXJEaXJlY3RpdmVdKTtcblx0fS5hcHBseShleHBvcnRzLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fKSwgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18gIT09IHVuZGVmaW5lZCAmJiAobW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXykpO1xuXG5cbi8qKiovIH0sXG4vKiAxICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHR2YXIgX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXywgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX187IShfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fID0gW19fd2VicGFja19yZXF1aXJlX18sIGV4cG9ydHNdLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyA9IGZ1bmN0aW9uIChyZXF1aXJlLCBleHBvcnRzKSB7XG5cdCAgICBcInVzZSBzdHJpY3RcIjtcblx0ICAgIHZhciBDb25maWdTZXJ2aWNlID0gKGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBmdW5jdGlvbiBDb25maWdTZXJ2aWNlKGNvbmZpZ3MsIGRlZmF1bHRDb25maWcsIGVuYWJsZSwgY2xhc3NOYW1lKSB7XG5cdCAgICAgICAgICAgIGlmIChjb25maWdzID09PSB2b2lkIDApIHsgY29uZmlncyA9IFtdOyB9XG5cdCAgICAgICAgICAgIGlmIChlbmFibGUgPT09IHZvaWQgMCkgeyBlbmFibGUgPSB0cnVlOyB9XG5cdCAgICAgICAgICAgIGlmIChjbGFzc05hbWUgPT09IHZvaWQgMCkgeyBjbGFzc05hbWUgPSAnbmctY2xvYWsnOyB9XG5cdCAgICAgICAgICAgIHRoaXMuY29uZmlncyA9IGNvbmZpZ3M7XG5cdCAgICAgICAgICAgIHRoaXMuZGVmYXVsdCA9IGRlZmF1bHRDb25maWc7XG5cdCAgICAgICAgICAgIHRoaXMuZW5hYmxlID0gZW5hYmxlO1xuXHQgICAgICAgICAgICB0aGlzLmNsYXNzTmFtZSA9IGNsYXNzTmFtZTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgQ29uZmlnU2VydmljZS5wcm90b3R5cGUuZ2V0VGVtcGxhdGVzID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICByZXR1cm4gdGhpcy5jb25maWdzO1xuXHQgICAgICAgIH07XG5cdCAgICAgICAgQ29uZmlnU2VydmljZS5wcm90b3R5cGUuZ2V0RGVmYXVsdFRlbXBsYXRlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICByZXR1cm4gdGhpcy5kZWZhdWx0O1xuXHQgICAgICAgIH07XG5cdCAgICAgICAgQ29uZmlnU2VydmljZS5wcm90b3R5cGUuZ2V0Q2xhc3NOYW1lID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICByZXR1cm4gdGhpcy5jbGFzc05hbWU7XG5cdCAgICAgICAgfTtcblx0ICAgICAgICBDb25maWdTZXJ2aWNlLnByb3RvdHlwZS5pc0VuYWJsZWQgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgIHJldHVybiB0aGlzLmVuYWJsZTtcblx0ICAgICAgICB9O1xuXHQgICAgICAgIHJldHVybiBDb25maWdTZXJ2aWNlO1xuXHQgICAgfSgpKTtcblx0ICAgIGV4cG9ydHMuQ29uZmlnU2VydmljZSA9IENvbmZpZ1NlcnZpY2U7XG5cdCAgICB2YXIgUGxhY2Vob2xkZXJQcm92aWRlciA9IChmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgZnVuY3Rpb24gUGxhY2Vob2xkZXJQcm92aWRlcigpIHtcblx0ICAgICAgICAgICAgdGhpcy5jb25maWdzID0gbmV3IEFycmF5KCk7XG5cdCAgICAgICAgICAgIHRoaXMuY3VzdG9tQ2xhc3MgPSAnbmctcGxhY2Vob2xkZXItaGlkZSc7XG5cdCAgICAgICAgICAgIHRoaXMuZGVmYXVsdENvbmZpZyA9IHtcblx0ICAgICAgICAgICAgICAgIHRlbXBsYXRlX2lkOiAnZGVmYXVsdCcsXG5cdCAgICAgICAgICAgICAgICB0ZW1wbGF0ZV9odG1sOiAnPHA+TG9hZGluZy4uLjwvcD4nLFxuXHQgICAgICAgICAgICAgICAgdGVtcGxhdGVfcmVwZWF0czogMVxuXHQgICAgICAgICAgICB9O1xuXHQgICAgICAgIH1cblx0ICAgICAgICBQbGFjZWhvbGRlclByb3ZpZGVyLnByb3RvdHlwZS5hZGRDb25maWcgPSBmdW5jdGlvbiAoY29uZmlnKSB7XG5cdCAgICAgICAgICAgIHRoaXMuY29uZmlncy5wdXNoKGNvbmZpZyk7XG5cdCAgICAgICAgfTtcblx0ICAgICAgICBQbGFjZWhvbGRlclByb3ZpZGVyLnByb3RvdHlwZS5zZXRDb25maWdzID0gZnVuY3Rpb24gKGNvbmZpZ3MpIHtcblx0ICAgICAgICAgICAgdGhpcy5jb25maWdzID0gY29uZmlncztcblx0ICAgICAgICB9O1xuXHQgICAgICAgIFBsYWNlaG9sZGVyUHJvdmlkZXIucHJvdG90eXBlLnNldEN1c3RvbUNsYXNzID0gZnVuY3Rpb24gKGNsYXNzTmFtZSkge1xuXHQgICAgICAgICAgICB0aGlzLmN1c3RvbUNsYXNzID0gY2xhc3NOYW1lO1xuXHQgICAgICAgIH07XG5cdCAgICAgICAgUGxhY2Vob2xkZXJQcm92aWRlci5wcm90b3R5cGUuc2V0RGVmYXVsdENvbmZpZyA9IGZ1bmN0aW9uIChkZWZhdWx0Q29uZmlnKSB7XG5cdCAgICAgICAgICAgIHRoaXMuZGVmYXVsdENvbmZpZyA9IGRlZmF1bHRDb25maWc7XG5cdCAgICAgICAgfTtcblx0ICAgICAgICBQbGFjZWhvbGRlclByb3ZpZGVyLnByb3RvdHlwZS5lbmFibGUgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgIHRoaXMuYWN0aXZlID0gdHJ1ZTtcblx0ICAgICAgICB9O1xuXHQgICAgICAgIFBsYWNlaG9sZGVyUHJvdmlkZXIucHJvdG90eXBlLmRpc2FibGUgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgIHRoaXMuYWN0aXZlID0gZmFsc2U7XG5cdCAgICAgICAgfTtcblx0ICAgICAgICBQbGFjZWhvbGRlclByb3ZpZGVyLnByb3RvdHlwZS4kZ2V0ID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICByZXR1cm4gbmV3IENvbmZpZ1NlcnZpY2UodGhpcy5jb25maWdzLCB0aGlzLmRlZmF1bHRDb25maWcsIHRoaXMuYWN0aXZlLCB0aGlzLmN1c3RvbUNsYXNzKTtcblx0ICAgICAgICB9O1xuXHQgICAgICAgIHJldHVybiBQbGFjZWhvbGRlclByb3ZpZGVyO1xuXHQgICAgfSgpKTtcblx0ICAgIGV4cG9ydHMuUGxhY2Vob2xkZXJQcm92aWRlciA9IFBsYWNlaG9sZGVyUHJvdmlkZXI7XG5cdH0uYXBwbHkoZXhwb3J0cywgX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXyksIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fICE9PSB1bmRlZmluZWQgJiYgKG1vZHVsZS5leHBvcnRzID0gX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18pKTtcblxuXG4vKioqLyB9LFxuLyogMiAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0dmFyIF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18sIF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fOyEoX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXyA9IFtfX3dlYnBhY2tfcmVxdWlyZV9fLCBleHBvcnRzXSwgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18gPSBmdW5jdGlvbiAocmVxdWlyZSwgZXhwb3J0cykge1xuXHQgICAgXCJ1c2Ugc3RyaWN0XCI7XG5cdCAgICB2YXIgUGxhY2Vob2xkZXJTZXJ2aWNlID0gKGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBmdW5jdGlvbiBQbGFjZWhvbGRlclNlcnZpY2UoY29tcGlsZWRDb25maWdzLCBkZWZhdWx0Q29tcGlsZWRDb25maWcsIGNsYXNzTmFtZSkge1xuXHQgICAgICAgICAgICB0aGlzLmNvbmZpZ3MgPSBjb21waWxlZENvbmZpZ3M7XG5cdCAgICAgICAgICAgIHRoaXMuZGVmYXVsdENvbmZpZyA9IGRlZmF1bHRDb21waWxlZENvbmZpZztcblx0ICAgICAgICAgICAgdGhpcy5jbGFzc05hbWUgPSBjbGFzc05hbWU7XG5cdCAgICAgICAgfVxuXHQgICAgICAgIFBsYWNlaG9sZGVyU2VydmljZS5nZXRJbnN0YW50ID0gZnVuY3Rpb24gKCR0ZW1wbGF0ZUNhY2hlLCBwbGFjZWhvbGRlckNvbmZpZ3MpIHtcblx0ICAgICAgICAgICAgaWYgKGFuZ3VsYXIuaXNVbmRlZmluZWQoUGxhY2Vob2xkZXJTZXJ2aWNlLmluc3RhbnQpKSB7XG5cdCAgICAgICAgICAgICAgICB2YXIgZGVmYXVsdENvbmZpZyA9IHBsYWNlaG9sZGVyQ29uZmlncy5nZXREZWZhdWx0VGVtcGxhdGUoKTtcblx0ICAgICAgICAgICAgICAgIHZhciBjb21waWxlZENvbmZpZ3MgPSBQbGFjZWhvbGRlclNlcnZpY2UuY29tcGlsZUNvbmZpZ3MocGxhY2Vob2xkZXJDb25maWdzLmdldFRlbXBsYXRlcygpLCAkdGVtcGxhdGVDYWNoZSk7XG5cdCAgICAgICAgICAgICAgICB2YXIgY29tcGlsZWREZWZhdWx0Q29uZmlncyA9IFBsYWNlaG9sZGVyU2VydmljZS5idWlsZENvbmZpZyhkZWZhdWx0Q29uZmlnLnRlbXBsYXRlX2lkLCBkZWZhdWx0Q29uZmlnLnRlbXBsYXRlX2h0bWwsIGRlZmF1bHRDb25maWcudGVtcGxhdGVfcmVwZWF0cyk7XG5cdCAgICAgICAgICAgICAgICBQbGFjZWhvbGRlclNlcnZpY2UuaW5zdGFudCA9IG5ldyBQbGFjZWhvbGRlclNlcnZpY2UoY29tcGlsZWRDb25maWdzLCBjb21waWxlZERlZmF1bHRDb25maWdzLCBwbGFjZWhvbGRlckNvbmZpZ3MuZ2V0Q2xhc3NOYW1lKCkpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIHJldHVybiBQbGFjZWhvbGRlclNlcnZpY2UuaW5zdGFudDtcblx0ICAgICAgICB9O1xuXHQgICAgICAgIFBsYWNlaG9sZGVyU2VydmljZS5nZXRUZW1wbGF0ZUh0bWwgPSBmdW5jdGlvbiAodGVtcGxhdGVfcGF0aCwgdGVtcGxhdGVDYWNoZSkge1xuXHQgICAgICAgICAgICByZXR1cm4gdGVtcGxhdGVDYWNoZS5nZXQodGVtcGxhdGVfcGF0aCk7XG5cdCAgICAgICAgfTtcblx0ICAgICAgICBQbGFjZWhvbGRlclNlcnZpY2UucmVwZWF0VGVtcGxhdGUgPSBmdW5jdGlvbiAodGVtcGxhdGVfaHRtbCwgdGVtcGxhdGVfcmVwZWF0KSB7XG5cdCAgICAgICAgICAgIHZhciBodG1sID0gYW5ndWxhci5jb3B5KHRlbXBsYXRlX2h0bWwpO1xuXHQgICAgICAgICAgICB0ZW1wbGF0ZV9yZXBlYXQgPSB0ZW1wbGF0ZV9yZXBlYXQgLSAxO1xuXHQgICAgICAgICAgICBmb3IgKHZhciBpbmRleCA9IDA7IGluZGV4IDwgdGVtcGxhdGVfcmVwZWF0OyBpbmRleCsrKSB7XG5cdCAgICAgICAgICAgICAgICBodG1sID0gaHRtbCArIHRlbXBsYXRlX2h0bWw7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgcmV0dXJuIGh0bWw7XG5cdCAgICAgICAgfTtcblx0ICAgICAgICBQbGFjZWhvbGRlclNlcnZpY2UuYnVpbGRDb25maWcgPSBmdW5jdGlvbiAodGVtcGxhdGVfaWQsIHRlbXBsYXRlX2h0bWwsIHRlbXBsYXRlX3JlcGVhdCkge1xuXHQgICAgICAgICAgICB2YXIgdGVtcGxhdGUgPSBQbGFjZWhvbGRlclNlcnZpY2UucmVwZWF0VGVtcGxhdGUodGVtcGxhdGVfaHRtbCwgdGVtcGxhdGVfcmVwZWF0KTtcblx0ICAgICAgICAgICAgcmV0dXJuIHtcblx0ICAgICAgICAgICAgICAgIHRlbXBsYXRlX2lkOiB0ZW1wbGF0ZV9pZCxcblx0ICAgICAgICAgICAgICAgIHRlbXBsYXRlX2h0bWw6IHRlbXBsYXRlX2h0bWwsXG5cdCAgICAgICAgICAgICAgICB0ZW1wbGF0ZV9yZXBlYXQ6IHRlbXBsYXRlX3JlcGVhdCxcblx0ICAgICAgICAgICAgICAgIHRlbXBsYXRlX2NvbXBpbGVkOiBhbmd1bGFyLmVsZW1lbnQodGVtcGxhdGUpXG5cdCAgICAgICAgICAgIH07XG5cdCAgICAgICAgfTtcblx0ICAgICAgICBQbGFjZWhvbGRlclNlcnZpY2UuY29tcGlsZUNvbmZpZ3MgPSBmdW5jdGlvbiAoY29uZmlncywgJHRlbXBsYXRlQ2FjaGUpIHtcblx0ICAgICAgICAgICAgdmFyIGNvbXBpbGVkQ29uZmlncyA9IG5ldyBBcnJheSgpO1xuXHQgICAgICAgICAgICB2YXIgY29tcGlsZWRDb25maWc7XG5cdCAgICAgICAgICAgIHZhciB0ZW1wbGF0ZV9pZDtcblx0ICAgICAgICAgICAgdmFyIHRlbXBsYXRlX3BhdGg7XG5cdCAgICAgICAgICAgIHZhciB0ZW1wbGF0ZV9odG1sO1xuXHQgICAgICAgICAgICB2YXIgdGVtcGxhdGVfcmVwZWF0O1xuXHQgICAgICAgICAgICBjb25maWdzLmZvckVhY2goZnVuY3Rpb24gaXRlcmF0b3IoY29uZmlnKSB7XG5cdCAgICAgICAgICAgICAgICB0ZW1wbGF0ZV9pZCA9IGNvbmZpZy50ZW1wbGF0ZV9pZDtcblx0ICAgICAgICAgICAgICAgIHRlbXBsYXRlX2h0bWwgPSBQbGFjZWhvbGRlclNlcnZpY2UuZ2V0VGVtcGxhdGVIdG1sKGNvbmZpZy50ZW1wbGF0ZV9wYXRoLCAkdGVtcGxhdGVDYWNoZSkgfHwgY29uZmlnLnRlbXBsYXRlX2h0bWw7XG5cdCAgICAgICAgICAgICAgICB0ZW1wbGF0ZV9yZXBlYXQgPSBjb25maWcudGVtcGxhdGVfcmVwZWF0cyB8fCAxO1xuXHQgICAgICAgICAgICAgICAgY29tcGlsZWRDb25maWcgPSBQbGFjZWhvbGRlclNlcnZpY2UuYnVpbGRDb25maWcodGVtcGxhdGVfaWQsIHRlbXBsYXRlX2h0bWwsIHRlbXBsYXRlX3JlcGVhdCk7XG5cdCAgICAgICAgICAgICAgICBjb21waWxlZENvbmZpZ3MucHVzaChjb21waWxlZENvbmZpZyk7XG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICByZXR1cm4gY29tcGlsZWRDb25maWdzO1xuXHQgICAgICAgIH07XG5cdCAgICAgICAgUGxhY2Vob2xkZXJTZXJ2aWNlLnByb3RvdHlwZS5yZXBlYXRUZW1wbGF0ZSA9IGZ1bmN0aW9uIChjb25maWcsIHRlbXBsYXRlX3JlcGVhdHMpIHtcblx0ICAgICAgICAgICAgaWYgKGNvbmZpZy50ZW1wbGF0ZV9yZXBlYXQgPT09IHRlbXBsYXRlX3JlcGVhdHMgfHwgYW5ndWxhci5pc1VuZGVmaW5lZCh0ZW1wbGF0ZV9yZXBlYXRzKSkge1xuXHQgICAgICAgICAgICAgICAgcmV0dXJuIGNvbmZpZy50ZW1wbGF0ZV9jb21waWxlZDtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB2YXIgdGVtcGxhdGUgPSBQbGFjZWhvbGRlclNlcnZpY2UucmVwZWF0VGVtcGxhdGUoY29uZmlnLnRlbXBsYXRlX2h0bWwsIHRlbXBsYXRlX3JlcGVhdHMpO1xuXHQgICAgICAgICAgICByZXR1cm4gYW5ndWxhci5lbGVtZW50KHRlbXBsYXRlKTtcblx0ICAgICAgICB9O1xuXHQgICAgICAgIFBsYWNlaG9sZGVyU2VydmljZS5wcm90b3R5cGUuZ2V0VGVtcGxhdGUgPSBmdW5jdGlvbiAodGVtcGxhdGVfaWQsIHRlbXBsYXRlX3JlcGVhdHMpIHtcblx0ICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuXHQgICAgICAgICAgICB2YXIgdGVtcGxhdGUgPSBzZWxmLmRlZmF1bHRDb25maWcudGVtcGxhdGVfY29tcGlsZWQ7XG5cdCAgICAgICAgICAgIHNlbGYuY29uZmlncy5mb3JFYWNoKGZ1bmN0aW9uIGNvbmZpZ0l0ZXJhdG9yKGNvbmZpZykge1xuXHQgICAgICAgICAgICAgICAgaWYgKGNvbmZpZy50ZW1wbGF0ZV9pZCA9PT0gdGVtcGxhdGVfaWQpIHtcblx0ICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZSA9IHNlbGYucmVwZWF0VGVtcGxhdGUoY29uZmlnLCB0ZW1wbGF0ZV9yZXBlYXRzKTtcblx0ICAgICAgICAgICAgICAgICAgICByZXR1cm47XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICByZXR1cm4gdGVtcGxhdGU7XG5cdCAgICAgICAgfTtcblx0ICAgICAgICBQbGFjZWhvbGRlclNlcnZpY2UucHJvdG90eXBlLmdldENsYXNzTmFtZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2xhc3NOYW1lO1xuXHQgICAgICAgIH07XG5cdCAgICAgICAgcmV0dXJuIFBsYWNlaG9sZGVyU2VydmljZTtcblx0ICAgIH0oKSk7XG5cdCAgICBleHBvcnRzLlBsYWNlaG9sZGVyU2VydmljZSA9IFBsYWNlaG9sZGVyU2VydmljZTtcblx0fS5hcHBseShleHBvcnRzLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fKSwgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX18gIT09IHVuZGVmaW5lZCAmJiAobW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXykpO1xuXG5cbi8qKiovIH0sXG4vKiAzICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHR2YXIgX19XRUJQQUNLX0FNRF9ERUZJTkVfQVJSQVlfXywgX19XRUJQQUNLX0FNRF9ERUZJTkVfUkVTVUxUX187IShfX1dFQlBBQ0tfQU1EX0RFRklORV9BUlJBWV9fID0gW19fd2VicGFja19yZXF1aXJlX18sIGV4cG9ydHNdLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyA9IGZ1bmN0aW9uIChyZXF1aXJlLCBleHBvcnRzKSB7XG5cdCAgICBcInVzZSBzdHJpY3RcIjtcblx0ICAgIGZ1bmN0aW9uIFBsYWNlaG9sZGVyRGlyZWN0aXZlKCRhbmltYXRlLCBwbGFjZWhvbGRlclNlcnZpY2UpIHtcblx0ICAgICAgICByZXR1cm4ge1xuXHQgICAgICAgICAgICB0cmFuc2NsdWRlOiAnZWxlbWVudCcsXG5cdCAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uIGxpbmtGdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMsIGNvbnRyb2xsZXIsIHRyYW5zY2x1ZGVGbikge1xuXHQgICAgICAgICAgICAgICAgdmFyIHRlbXBsYXRlX2lkID0gYXR0cnMudGVtcGxhdGVJZDtcblx0ICAgICAgICAgICAgICAgIHZhciB0ZW1wbGF0ZV9yZXBlYXRzID0gcGFyc2VJbnQoYXR0cnMudGVtcGxhdGVSZXBlYXRzLCAxMCk7XG5cdCAgICAgICAgICAgICAgICB2YXIgdGVtcGxhdGUgPSBwbGFjZWhvbGRlclNlcnZpY2UuZ2V0VGVtcGxhdGUodGVtcGxhdGVfaWQsIHRlbXBsYXRlX3JlcGVhdHMpO1xuXHQgICAgICAgICAgICAgICAgdmFyIGNsYXNzTmFtZSA9IHBsYWNlaG9sZGVyU2VydmljZS5nZXRDbGFzc05hbWUoKTtcblx0ICAgICAgICAgICAgICAgIHZhciBjaGlsZHJlbnM7XG5cdCAgICAgICAgICAgICAgICB0cmFuc2NsdWRlRm4oc2NvcGUsIGZ1bmN0aW9uIHRyYW5zY2x1ZGVGdW5jdGlvbihjbG9uZSwgc2NvcGUpIHtcblx0ICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbnMgPSBjbG9uZS5jaGlsZHJlbigpO1xuXHQgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBjaGlsZHJlbnMubGVuZ3RoOyBpbmRleCsrKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuc1tpbmRleF0gPSBhbmd1bGFyLmVsZW1lbnQoY2hpbGRyZW5zW2luZGV4XSk7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuc1tpbmRleF0uYWRkQ2xhc3MoY2xhc3NOYW1lKTtcblx0ICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICAgICAgY2xvbmUuYXBwZW5kKHRlbXBsYXRlKTtcblx0ICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnJlcGxhY2VXaXRoKGNsb25lKTtcblx0ICAgICAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgICAgICAgYXR0cnMuJG9ic2VydmUoJ3Nob3dVbnRpbCcsIGZ1bmN0aW9uICh2YWx1ZSkge1xuXHQgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gJ3RydWUnKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGluZGV4ID0gMDsgaW5kZXggPCBjaGlsZHJlbnMubGVuZ3RoOyBpbmRleCsrKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbnNbaW5kZXhdLnJlbW92ZUNsYXNzKGNsYXNzTmFtZSk7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGUucmVtb3ZlKCk7XG5cdCAgICAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICB9O1xuXHQgICAgfVxuXHQgICAgZXhwb3J0cy5QbGFjZWhvbGRlckRpcmVjdGl2ZSA9IFBsYWNlaG9sZGVyRGlyZWN0aXZlO1xuXHR9LmFwcGx5KGV4cG9ydHMsIF9fV0VCUEFDS19BTURfREVGSU5FX0FSUkFZX18pLCBfX1dFQlBBQ0tfQU1EX0RFRklORV9SRVNVTFRfXyAhPT0gdW5kZWZpbmVkICYmIChtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19BTURfREVGSU5FX1JFU1VMVF9fKSk7XG5cblxuLyoqKi8gfVxuLyoqKioqKi8gXSk7XG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogZGlzdC9uZy1wbGFjZWhvbGRlci5qc1xuICoqLyIsIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuXG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRleHBvcnRzOiB7fSxcbiBcdFx0XHRpZDogbW9kdWxlSWQsXG4gXHRcdFx0bG9hZGVkOiBmYWxzZVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuXG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogd2VicGFjay9ib290c3RyYXAgODBiN2QxNGE1MTJhYjczODllNGZcbiAqKi8iLCJpbXBvcnQge1BsYWNlaG9sZGVyUHJvdmlkZXJ9IGZyb20gJy4vbmctcGxhY2Vob2xkZXItcHJvdmlkZXInO1xuaW1wb3J0IHtQbGFjZWhvbGRlclNlcnZpY2V9IGZyb20gJy4vbmctcGxhY2Vob2xkZXItc2VydmljZSc7XG5pbXBvcnQge1BsYWNlaG9sZGVyRGlyZWN0aXZlfSBmcm9tICcuL25nLXBsYWNlaG9sZGVyLWRpcmVjdGl2ZSc7XG5cbmNvbnN0IGFwcCA9IGFuZ3VsYXIubW9kdWxlKCduZy1wbGFjZWhvbGRlcicsIFsnbmdBbmltYXRlJ10pO1xuXG5hcHAucHJvdmlkZXIoJ05nUGxhY2Vob2xkZXJDb25maWcnLCBbUGxhY2Vob2xkZXJQcm92aWRlcl0pO1xuYXBwLnNlcnZpY2UoJ05nUGxhY2Vob2xkZXJTZXJ2aWNlJywgWyckdGVtcGxhdGVDYWNoZScsICdOZ1BsYWNlaG9sZGVyQ29uZmlnJywgUGxhY2Vob2xkZXJTZXJ2aWNlLmdldEluc3RhbnRdKTtcbmFwcC5kaXJlY3RpdmUoJ25nUGxhY2Vob2xkZXInLCBbJyRhbmltYXRlJywgJ05nUGxhY2Vob2xkZXJTZXJ2aWNlJywgUGxhY2Vob2xkZXJEaXJlY3RpdmVdKTtcblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9uZy1wbGFjZWhvbGRlci50c1xuICoqLyIsImV4cG9ydCBpbnRlcmZhY2UgSUNvbmZpZ01vZGVsIHtcbiAgICB0ZW1wbGF0ZV9pZDogc3RyaW5nO1xuICAgIHRlbXBsYXRlX3BhdGg/OiBzdHJpbmc7XG4gICAgdGVtcGxhdGVfaHRtbD86IHN0cmluZztcbiAgICB0ZW1wbGF0ZV9yZXBlYXRzPzogbnVtYmVyO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIElQbGFjZWhvbGRlckNvbmZpZ3Mge1xuICAgIGdldFRlbXBsYXRlcygpOiBBcnJheTxJQ29uZmlnTW9kZWw+O1xuICAgIGdldERlZmF1bHRUZW1wbGF0ZSgpOiBJQ29uZmlnTW9kZWw7XG4gICAgZ2V0Q2xhc3NOYW1lKCk6IHN0cmluZ1xuICAgIGlzRW5hYmxlZCgpOiBib29sZWFuO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIElQbGFjZWhvbGRlckNvbmZpZ1Byb3ZpZGVyIGV4dGVuZHMgbmcuSVNlcnZpY2VQcm92aWRlciB7XG4gICAgYWRkQ29uZmlnKGNvbmZpZzogSUNvbmZpZ01vZGVsKTogdm9pZDtcbiAgICBzZXRDb25maWdzKGNvbmZpZ3M6IEFycmF5PElDb25maWdNb2RlbD4pOiB2b2lkO1xuICAgIHNldEN1c3RvbUNsYXNzKGNsYXNzTmFtZTogc3RyaW5nKTogdm9pZDtcbiAgICBzZXREZWZhdWx0Q29uZmlnKGRlZmF1bHRDb25maWc6IElDb25maWdNb2RlbCk6IHZvaWQ7XG4gICAgZW5hYmxlKCk6IHZvaWQ7XG4gICAgZGlzYWJsZSgpOiB2b2lkO1xufVxuXG5leHBvcnQgY2xhc3MgQ29uZmlnU2VydmljZSBpbXBsZW1lbnRzIElQbGFjZWhvbGRlckNvbmZpZ3Mge1xuICAgIHByaXZhdGUgY29uZmlnczogQXJyYXk8SUNvbmZpZ01vZGVsPjtcbiAgICBwcml2YXRlIGRlZmF1bHQ6IElDb25maWdNb2RlbDtcbiAgICBwcml2YXRlIGVuYWJsZTogYm9vbGVhbjtcbiAgICBwcml2YXRlIGNsYXNzTmFtZTogc3RyaW5nO1xuXG4gICAgY29uc3RydWN0b3IoY29uZmlnczogQXJyYXk8SUNvbmZpZ01vZGVsPiA9IFtdLCBkZWZhdWx0Q29uZmlnOiBJQ29uZmlnTW9kZWwsIGVuYWJsZTogYm9vbGVhbiA9IHRydWUsIGNsYXNzTmFtZTogc3RyaW5nID0gJ25nLWNsb2FrJykge1xuICAgICAgICB0aGlzLmNvbmZpZ3MgPSBjb25maWdzO1xuICAgICAgICB0aGlzLmRlZmF1bHQgPSBkZWZhdWx0Q29uZmlnO1xuICAgICAgICB0aGlzLmVuYWJsZSA9IGVuYWJsZTtcbiAgICAgICAgdGhpcy5jbGFzc05hbWUgPSBjbGFzc05hbWU7XG4gICAgfVxuXG4gICAgZ2V0VGVtcGxhdGVzKCk6IEFycmF5PElDb25maWdNb2RlbD4ge1xuICAgICAgICByZXR1cm4gdGhpcy5jb25maWdzO1xuICAgIH1cblxuICAgIGdldERlZmF1bHRUZW1wbGF0ZSgpOiBJQ29uZmlnTW9kZWwge1xuICAgICAgICByZXR1cm4gdGhpcy5kZWZhdWx0O1xuICAgIH1cblxuICAgIGdldENsYXNzTmFtZSgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5jbGFzc05hbWU7XG4gICAgfVxuXG4gICAgaXNFbmFibGVkKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5lbmFibGU7XG4gICAgfVxuXG59XG5cbmV4cG9ydCBjbGFzcyBQbGFjZWhvbGRlclByb3ZpZGVyIGltcGxlbWVudHMgSVBsYWNlaG9sZGVyQ29uZmlnUHJvdmlkZXIge1xuXG4gICAgcHJpdmF0ZSBjb25maWdzOiBBcnJheTxJQ29uZmlnTW9kZWw+O1xuICAgIHByaXZhdGUgZGVmYXVsdENvbmZpZzogSUNvbmZpZ01vZGVsO1xuICAgIHByaXZhdGUgYWN0aXZlOiBib29sZWFuO1xuICAgIHByaXZhdGUgY3VzdG9tQ2xhc3M6IHN0cmluZztcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLmNvbmZpZ3MgPSBuZXcgQXJyYXkoKTtcbiAgICAgICAgdGhpcy5jdXN0b21DbGFzcyA9ICduZy1wbGFjZWhvbGRlci1oaWRlJztcbiAgICAgICAgdGhpcy5kZWZhdWx0Q29uZmlnID0ge1xuICAgICAgICAgICAgdGVtcGxhdGVfaWQ6ICdkZWZhdWx0JyxcbiAgICAgICAgICAgIHRlbXBsYXRlX2h0bWw6ICc8cD5Mb2FkaW5nLi4uPC9wPicsXG4gICAgICAgICAgICB0ZW1wbGF0ZV9yZXBlYXRzOiAxXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgYWRkQ29uZmlnKGNvbmZpZzogSUNvbmZpZ01vZGVsKTogdm9pZCB7XG4gICAgICAgIHRoaXMuY29uZmlncy5wdXNoKGNvbmZpZyk7XG4gICAgfVxuXG4gICAgc2V0Q29uZmlncyhjb25maWdzOiBBcnJheTxJQ29uZmlnTW9kZWw+KTogdm9pZCB7XG4gICAgICAgIHRoaXMuY29uZmlncyA9IGNvbmZpZ3M7XG4gICAgfVxuXG4gICAgc2V0Q3VzdG9tQ2xhc3MoY2xhc3NOYW1lOiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5jdXN0b21DbGFzcyA9IGNsYXNzTmFtZTtcbiAgICB9XG5cbiAgICBzZXREZWZhdWx0Q29uZmlnKGRlZmF1bHRDb25maWc6IElDb25maWdNb2RlbCk6IHZvaWQge1xuICAgICAgICB0aGlzLmRlZmF1bHRDb25maWcgPSBkZWZhdWx0Q29uZmlnO1xuICAgIH1cblxuICAgIGVuYWJsZSgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5hY3RpdmUgPSB0cnVlO1xuICAgIH1cblxuICAgIGRpc2FibGUoKTogdm9pZCB7XG4gICAgICAgIHRoaXMuYWN0aXZlID0gZmFsc2U7XG4gICAgfVxuXG4gICAgJGdldCgpOiBJUGxhY2Vob2xkZXJDb25maWdzIHtcbiAgICAgICAgcmV0dXJuIG5ldyBDb25maWdTZXJ2aWNlKHRoaXMuY29uZmlncywgdGhpcy5kZWZhdWx0Q29uZmlnLCB0aGlzLmFjdGl2ZSwgdGhpcy5jdXN0b21DbGFzcyk7XG4gICAgfVxufVxuXG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9uZy1wbGFjZWhvbGRlci1wcm92aWRlci50c1xuICoqLyIsImltcG9ydCB7IElQbGFjZWhvbGRlckNvbmZpZ3MsIElDb25maWdNb2RlbCB9IGZyb20gJy4vbmctcGxhY2Vob2xkZXItcHJvdmlkZXInO1xuXG5leHBvcnQgaW50ZXJmYWNlIElDb21waWxlZENvbmZpZ01vZGVsIHtcbiAgICB0ZW1wbGF0ZV9pZDogc3RyaW5nO1xuICAgIHRlbXBsYXRlX2h0bWw6IHN0cmluZztcbiAgICB0ZW1wbGF0ZV9yZXBlYXQ6IG51bWJlcjtcbiAgICB0ZW1wbGF0ZV9jb21waWxlZDogSlF1ZXJ5XG59XG5cbmV4cG9ydCBjbGFzcyBQbGFjZWhvbGRlclNlcnZpY2Uge1xuXG4gICAgcHJpdmF0ZSBzdGF0aWMgaW5zdGFudDogUGxhY2Vob2xkZXJTZXJ2aWNlO1xuICAgIHByaXZhdGUgY29uZmlnczogQXJyYXk8SUNvbXBpbGVkQ29uZmlnTW9kZWw+O1xuICAgIHByaXZhdGUgZGVmYXVsdENvbmZpZzogSUNvbXBpbGVkQ29uZmlnTW9kZWw7XG4gICAgcHJpdmF0ZSBjbGFzc05hbWU6IHN0cmluZztcblxuICAgIGNvbnN0cnVjdG9yKGNvbXBpbGVkQ29uZmlnczogQXJyYXk8SUNvbXBpbGVkQ29uZmlnTW9kZWw+LCBkZWZhdWx0Q29tcGlsZWRDb25maWc6IElDb21waWxlZENvbmZpZ01vZGVsLCBjbGFzc05hbWU6IHN0cmluZykge1xuICAgICAgICB0aGlzLmNvbmZpZ3MgPSBjb21waWxlZENvbmZpZ3M7XG4gICAgICAgIHRoaXMuZGVmYXVsdENvbmZpZyA9IGRlZmF1bHRDb21waWxlZENvbmZpZztcbiAgICAgICAgdGhpcy5jbGFzc05hbWUgPSBjbGFzc05hbWU7XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBnZXRJbnN0YW50KCR0ZW1wbGF0ZUNhY2hlOiBuZy5JVGVtcGxhdGVDYWNoZVNlcnZpY2UsIHBsYWNlaG9sZGVyQ29uZmlnczogSVBsYWNlaG9sZGVyQ29uZmlncykge1xuICAgICAgICBpZiAoYW5ndWxhci5pc1VuZGVmaW5lZChQbGFjZWhvbGRlclNlcnZpY2UuaW5zdGFudCkpIHtcbiAgICAgICAgICAgIGNvbnN0IGRlZmF1bHRDb25maWcgPSBwbGFjZWhvbGRlckNvbmZpZ3MuZ2V0RGVmYXVsdFRlbXBsYXRlKCk7XG4gICAgICAgICAgICBjb25zdCBjb21waWxlZENvbmZpZ3MgPSBQbGFjZWhvbGRlclNlcnZpY2UuY29tcGlsZUNvbmZpZ3MocGxhY2Vob2xkZXJDb25maWdzLmdldFRlbXBsYXRlcygpLCAkdGVtcGxhdGVDYWNoZSk7XG4gICAgICAgICAgICBjb25zdCBjb21waWxlZERlZmF1bHRDb25maWdzID0gUGxhY2Vob2xkZXJTZXJ2aWNlLmJ1aWxkQ29uZmlnKGRlZmF1bHRDb25maWcudGVtcGxhdGVfaWQsIGRlZmF1bHRDb25maWcudGVtcGxhdGVfaHRtbCwgZGVmYXVsdENvbmZpZy50ZW1wbGF0ZV9yZXBlYXRzKTtcblxuICAgICAgICAgICAgUGxhY2Vob2xkZXJTZXJ2aWNlLmluc3RhbnQgPSBuZXcgUGxhY2Vob2xkZXJTZXJ2aWNlKGNvbXBpbGVkQ29uZmlncywgY29tcGlsZWREZWZhdWx0Q29uZmlncywgcGxhY2Vob2xkZXJDb25maWdzLmdldENsYXNzTmFtZSgpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBQbGFjZWhvbGRlclNlcnZpY2UuaW5zdGFudDtcbiAgICB9XG5cbiAgICBwcml2YXRlIHN0YXRpYyBnZXRUZW1wbGF0ZUh0bWwodGVtcGxhdGVfcGF0aDogc3RyaW5nLCB0ZW1wbGF0ZUNhY2hlOiBuZy5JVGVtcGxhdGVDYWNoZVNlcnZpY2UpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGVtcGxhdGVDYWNoZS5nZXQ8c3RyaW5nPih0ZW1wbGF0ZV9wYXRoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHN0YXRpYyByZXBlYXRUZW1wbGF0ZSh0ZW1wbGF0ZV9odG1sOiBzdHJpbmcsIHRlbXBsYXRlX3JlcGVhdDogbnVtYmVyKTogc3RyaW5nIHtcbiAgICAgICAgbGV0IGh0bWw6IHN0cmluZyA9IGFuZ3VsYXIuY29weSh0ZW1wbGF0ZV9odG1sKTtcbiAgICAgICAgdGVtcGxhdGVfcmVwZWF0ID0gdGVtcGxhdGVfcmVwZWF0IC0gMTtcblxuICAgICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgdGVtcGxhdGVfcmVwZWF0OyBpbmRleCsrKSB7XG4gICAgICAgICAgICBodG1sID0gaHRtbCArIHRlbXBsYXRlX2h0bWw7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gaHRtbDtcbiAgICB9XG5cbiAgICBwcml2YXRlIHN0YXRpYyBidWlsZENvbmZpZyh0ZW1wbGF0ZV9pZDogc3RyaW5nLCB0ZW1wbGF0ZV9odG1sOiBzdHJpbmcsIHRlbXBsYXRlX3JlcGVhdDogbnVtYmVyKTogSUNvbXBpbGVkQ29uZmlnTW9kZWwge1xuXG4gICAgICAgIGNvbnN0IHRlbXBsYXRlID0gUGxhY2Vob2xkZXJTZXJ2aWNlLnJlcGVhdFRlbXBsYXRlKHRlbXBsYXRlX2h0bWwsIHRlbXBsYXRlX3JlcGVhdCk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHRlbXBsYXRlX2lkOiB0ZW1wbGF0ZV9pZCxcbiAgICAgICAgICAgIHRlbXBsYXRlX2h0bWw6IHRlbXBsYXRlX2h0bWwsXG4gICAgICAgICAgICB0ZW1wbGF0ZV9yZXBlYXQ6IHRlbXBsYXRlX3JlcGVhdCxcbiAgICAgICAgICAgIHRlbXBsYXRlX2NvbXBpbGVkOiBhbmd1bGFyLmVsZW1lbnQodGVtcGxhdGUpXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBzdGF0aWMgY29tcGlsZUNvbmZpZ3MoY29uZmlnczogQXJyYXk8SUNvbmZpZ01vZGVsPiwgJHRlbXBsYXRlQ2FjaGU6IG5nLklUZW1wbGF0ZUNhY2hlU2VydmljZSk6IEFycmF5PElDb21waWxlZENvbmZpZ01vZGVsPiB7XG4gICAgICAgIGxldCBjb21waWxlZENvbmZpZ3M6IEFycmF5PElDb21waWxlZENvbmZpZ01vZGVsPiA9IG5ldyBBcnJheSgpO1xuICAgICAgICBsZXQgY29tcGlsZWRDb25maWc6IElDb21waWxlZENvbmZpZ01vZGVsO1xuICAgICAgICBsZXQgdGVtcGxhdGVfaWQ6IHN0cmluZztcbiAgICAgICAgbGV0IHRlbXBsYXRlX3BhdGg6IHN0cmluZztcbiAgICAgICAgbGV0IHRlbXBsYXRlX2h0bWw6IHN0cmluZztcbiAgICAgICAgbGV0IHRlbXBsYXRlX3JlcGVhdDogbnVtYmVyO1xuXG5cbiAgICAgICAgY29uZmlncy5mb3JFYWNoKGZ1bmN0aW9uIGl0ZXJhdG9yKGNvbmZpZzogSUNvbmZpZ01vZGVsKSB7XG5cbiAgICAgICAgICAgIHRlbXBsYXRlX2lkID0gY29uZmlnLnRlbXBsYXRlX2lkO1xuICAgICAgICAgICAgdGVtcGxhdGVfaHRtbCA9IFBsYWNlaG9sZGVyU2VydmljZS5nZXRUZW1wbGF0ZUh0bWwoY29uZmlnLnRlbXBsYXRlX3BhdGgsICR0ZW1wbGF0ZUNhY2hlKSB8fCBjb25maWcudGVtcGxhdGVfaHRtbDtcbiAgICAgICAgICAgIHRlbXBsYXRlX3JlcGVhdCA9IGNvbmZpZy50ZW1wbGF0ZV9yZXBlYXRzIHx8IDE7XG4gICAgICAgICAgICBjb21waWxlZENvbmZpZyA9IFBsYWNlaG9sZGVyU2VydmljZS5idWlsZENvbmZpZyh0ZW1wbGF0ZV9pZCwgdGVtcGxhdGVfaHRtbCwgdGVtcGxhdGVfcmVwZWF0KTtcblxuICAgICAgICAgICAgY29tcGlsZWRDb25maWdzLnB1c2goY29tcGlsZWRDb25maWcpO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gY29tcGlsZWRDb25maWdzO1xuICAgIH1cblxuICAgIHByaXZhdGUgcmVwZWF0VGVtcGxhdGUoY29uZmlnOiBJQ29tcGlsZWRDb25maWdNb2RlbCwgdGVtcGxhdGVfcmVwZWF0czogbnVtYmVyKTogSlF1ZXJ5IHtcbiAgICAgICAgaWYgKGNvbmZpZy50ZW1wbGF0ZV9yZXBlYXQgPT09IHRlbXBsYXRlX3JlcGVhdHMgfHwgYW5ndWxhci5pc1VuZGVmaW5lZCh0ZW1wbGF0ZV9yZXBlYXRzKSkge1xuICAgICAgICAgICAgcmV0dXJuIGNvbmZpZy50ZW1wbGF0ZV9jb21waWxlZDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHRlbXBsYXRlID0gUGxhY2Vob2xkZXJTZXJ2aWNlLnJlcGVhdFRlbXBsYXRlKGNvbmZpZy50ZW1wbGF0ZV9odG1sLCB0ZW1wbGF0ZV9yZXBlYXRzKTtcblxuICAgICAgICByZXR1cm4gYW5ndWxhci5lbGVtZW50KHRlbXBsYXRlKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0VGVtcGxhdGUodGVtcGxhdGVfaWQ6IHN0cmluZywgdGVtcGxhdGVfcmVwZWF0czogbnVtYmVyKTogSlF1ZXJ5IHtcbiAgICAgICAgbGV0IHNlbGYgPSB0aGlzO1xuICAgICAgICBsZXQgdGVtcGxhdGU6IEpRdWVyeSA9IHNlbGYuZGVmYXVsdENvbmZpZy50ZW1wbGF0ZV9jb21waWxlZDtcblxuICAgICAgICBzZWxmLmNvbmZpZ3MuZm9yRWFjaChmdW5jdGlvbiBjb25maWdJdGVyYXRvcihjb25maWc6IElDb21waWxlZENvbmZpZ01vZGVsKSB7XG4gICAgICAgICAgICBpZiAoY29uZmlnLnRlbXBsYXRlX2lkID09PSB0ZW1wbGF0ZV9pZCkge1xuICAgICAgICAgICAgICAgIHRlbXBsYXRlID0gc2VsZi5yZXBlYXRUZW1wbGF0ZShjb25maWcsIHRlbXBsYXRlX3JlcGVhdHMpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHRlbXBsYXRlO1xuICAgIH1cblxuICAgIGdldENsYXNzTmFtZSgpOiBzdHJpbmcge1xuICAgICAgICByZXR1cm4gdGhpcy5jbGFzc05hbWU7XG4gICAgfVxuXG59XG5cblxuLyoqIFdFQlBBQ0sgRk9PVEVSICoqXG4gKiogLi9zcmMvbmctcGxhY2Vob2xkZXItc2VydmljZS50c1xuICoqLyIsImltcG9ydCB7IFBsYWNlaG9sZGVyU2VydmljZSwgSUNvbXBpbGVkQ29uZmlnTW9kZWwgfSBmcm9tICcuL25nLXBsYWNlaG9sZGVyLXNlcnZpY2UnO1xuXG5leHBvcnQgaW50ZXJmYWNlIElOUFNjb3BlIGV4dGVuZHMgbmcuSUF0dHJpYnV0ZXMge1xuICAgIHRlbXBsYXRlSWQ6IHN0cmluZztcbiAgICB0ZW1wbGF0ZVJlcGVhdHM6IHN0cmluZztcbiAgICBzaG93VW50aWw6IHN0cmluZztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIFBsYWNlaG9sZGVyRGlyZWN0aXZlKCRhbmltYXRlOiBhbmd1bGFyLmFuaW1hdGUuSUFuaW1hdGVTZXJ2aWNlLCBwbGFjZWhvbGRlclNlcnZpY2U6IFBsYWNlaG9sZGVyU2VydmljZSkge1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgdHJhbnNjbHVkZTogJ2VsZW1lbnQnLFxuICAgICAgICBsaW5rOiBmdW5jdGlvbiBsaW5rRnVuY3Rpb24oXG4gICAgICAgICAgICBzY29wZTogbmcuSVNjb3BlLFxuICAgICAgICAgICAgZWxlbWVudDogbmcuSVJvb3RFbGVtZW50U2VydmljZSxcbiAgICAgICAgICAgIGF0dHJzOiBJTlBTY29wZSxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IG5nLklDb250cm9sbGVyUHJvdmlkZXIsXG4gICAgICAgICAgICB0cmFuc2NsdWRlRm46IG5nLklUcmFuc2NsdWRlRnVuY3Rpb25cbiAgICAgICAgKSB7XG4gICAgICAgICAgICBjb25zdCB0ZW1wbGF0ZV9pZDogc3RyaW5nICAgICAgID0gYXR0cnMudGVtcGxhdGVJZDtcbiAgICAgICAgICAgIGNvbnN0IHRlbXBsYXRlX3JlcGVhdHM6IG51bWJlciAgPSBwYXJzZUludChhdHRycy50ZW1wbGF0ZVJlcGVhdHMsIDEwKTtcbiAgICAgICAgICAgIGNvbnN0IHRlbXBsYXRlOiBKUXVlcnkgPSBwbGFjZWhvbGRlclNlcnZpY2UuZ2V0VGVtcGxhdGUodGVtcGxhdGVfaWQsIHRlbXBsYXRlX3JlcGVhdHMpO1xuICAgICAgICAgICAgY29uc3QgY2xhc3NOYW1lOiBzdHJpbmcgPSBwbGFjZWhvbGRlclNlcnZpY2UuZ2V0Q2xhc3NOYW1lKCk7XG4gICAgICAgICAgICBsZXQgY2hpbGRyZW5zOiBhbnk7XG5cbiAgICAgICAgICAgIHRyYW5zY2x1ZGVGbihzY29wZSwgZnVuY3Rpb24gdHJhbnNjbHVkZUZ1bmN0aW9uKGNsb25lOiBKUXVlcnksIHNjb3BlOiBuZy5JU2NvcGUpOiB2b2lkIHtcbiAgICAgICAgICAgICAgICBjaGlsZHJlbnMgPSBjbG9uZS5jaGlsZHJlbigpO1xuXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IGNoaWxkcmVucy5sZW5ndGg7IGluZGV4KyspIHtcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW5zW2luZGV4XSA9IGFuZ3VsYXIuZWxlbWVudChjaGlsZHJlbnNbaW5kZXhdKTtcbiAgICAgICAgICAgICAgICAgICAgY2hpbGRyZW5zW2luZGV4XS5hZGRDbGFzcyhjbGFzc05hbWUpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGNsb25lLmFwcGVuZCh0ZW1wbGF0ZSk7XG4gICAgICAgICAgICAgICAgZWxlbWVudC5yZXBsYWNlV2l0aChjbG9uZSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgYXR0cnMuJG9ic2VydmUoJ3Nob3dVbnRpbCcsICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSA9PT0gJ3RydWUnKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCBjaGlsZHJlbnMubGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbnNbaW5kZXhdLnJlbW92ZUNsYXNzKGNsYXNzTmFtZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGUucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIC4vc3JjL25nLXBsYWNlaG9sZGVyLWRpcmVjdGl2ZS50c1xuICoqLyJdLCJzb3VyY2VSb290IjoiIn0=